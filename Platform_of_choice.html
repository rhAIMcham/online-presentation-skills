<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Acknowledging your strengths</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
<style>
.txta {
    width: 100%;
    min-height: 100px;
    font-family: Arial, sans-serif;
    font-size: 16px;
    overflow: hidden;
    line-height: 1.4;
}

:root {
    --AIMblue: #4353A3;
    --darkBlue: #38416D;
    --teal: #5DC8B9;
    --cream: #F1EEDE;
    --grey: #e7e9ec;
    --rust: #AF4510;
    --navy: #12195C;
    --white: #ffffff;
    --lightBlue: #AEBAE4;
}

input {
    border: none;
    width: fit-content;

}

body {
    font-family: "IBM Plex Sans", sans-serif;
}

table {
    width: 100%;
    margin:0;
    padding:0;
    border-collapse: collapse;
    border-spacing: 0;
    text-align: left;
}

table tr {
    border: 1px solid var(--AIMblue);
    padding: 5px;
}

table th, table td {
    border: 1px solid var(--AIMblue);
    padding: 10px;
}

table th {
    font-size: 16px;
    font-weight: bold;
    letter-spacing: 1px;
    background-color: var(--darkBlue);
    color: var(--white);
}

tr:nth-child(even) {
    background-color: var(--grey); /*Grey of torment!*/
} 

tr:nth-child(odd) {
    background-color: white; 
} 

tr td:first-child {
    font-weight: bold;
}

/* @media screen and (max-width: 800px) {

table {
    border: 0;
    border: none;
}

table thead {
    display: none;
}

table tr {
    margin-bottom: 10px;
    display: block;
    border-bottom: 2px solid var(--AIMblue);
    border-left: 1px solid var(--lightBlue);
    border-right: 1px solid var(--lightBlue);
    border-top: 1px solid var(--lightBlue);
}

table td {
    display: block;
    text-align: right;
    font-size: 13px;
    border-bottom: 1px dotted var(--rust);
    border-left: 0px dotted #ccc;
    border-right: 0px dotted #ccc;
    border-top: 0px dotted #ccc;
}

table td:last-child {
    border-bottom: 0;
}

table td:before {
    content: attr(data-label);
    float: left;
    font-weight: bold;
}
}*/

</style>
  </head>
<body>
<div style="margin:12px 0; display:flex; gap:8px;">
  <button id="export-png" type="button">Export PNG</button>
  <button id="export-pdf" type="button">Export PDF</button>
</div>
  <table>
   <colgroup>
        <col style="width: 10%;">
        <col style="width: 30%;">
        <col style="width: 30%;">
        <col style="width: 30%;">
      </colgroup>
  <thead>
    <th>Platform</th>
    <th>Key strengths</th>
    <th>Limitations</th>
    <th>Best use case</th>
  </thead>
  <tbody>
    <tr>
        <td>Zoom</td>
        <td data-label="Zoom's key strengths">
            <textarea placeholder="Enter your thoughts here" class="txta"></textarea>
        </td>
        <td data-label="Zoom's limitations">
            <textarea placeholder="Enter your thoughts here" class="txta"></textarea>
        </td>
        <td data-label="Zoom's best use case">
            <textarea placeholder="Enter your thoughts here" class="txta"></textarea>
        </td>
    </tr>
    <tr>
        <td>Teams</td>
        <td data-label="Teams's key strengths">
            <textarea placeholder="Enter your thoughts here" class="txta"></textarea>
        </td>
        <td data-label="Teams's limitations">
            <textarea placeholder="Enter your thoughts here" class="txta"></textarea>
        </td>
        <td data-label="Teams's best use case">
            <textarea placeholder="Enter your thoughts here" class="txta"></textarea>
        </td>
    </tr>
    <tr>
        <td>Meet</td>
        <td data-label="Meet's key strengths">
            <textarea placeholder="Enter your thoughts here" class="txta"></textarea>
        </td>
        <td data-label="Meet's limitations">
            <textarea placeholder="Enter your thoughts here" class="txta"></textarea>
        </td>
        <td data-label="Meet's best use case">
            <textarea placeholder="Enter your thoughts here" class="txta"></textarea>
        </td>
    </tr>
  </tbody>
</table>
</body>
<script>
  // Targets all textareas with class "txta"
let textareas = document.querySelectorAll('.txta'),
    hiddenDiv = document.createElement('div'),
    content = null;

// Adds a class to all textareas
for (let j of textareas) {
  j.classList.add('txtstuff');
}

// Build the hidden div's attributes

// The line below is needed if you move the style lines to CSS
// hiddenDiv.classList.add('hiddendiv');

// Add the "txta" styles, which are common to both textarea and hiddendiv
// If you want, you can remove those from CSS and add them via JS
hiddenDiv.classList.add('txta');

// Add the styles for the hidden div
// These can be in the CSS, just remove these three lines and uncomment the CSS
hiddenDiv.style.display = 'none';
hiddenDiv.style.whiteSpace = 'pre-wrap';
hiddenDiv.style.wordWrap = 'break-word';

// Loop through all the textareas and add the event listener
for(let i of textareas) {
  (function(i) {
    // Note: Use 'keyup' instead of 'input'
    // if you want older IE support
    i.addEventListener('input', function() {
      
      // Append hiddendiv to parent of textarea, so the size is correct
      i.parentNode.appendChild(hiddenDiv);
      
      // Remove this if you want the user to be able to resize it in modern browsers
      i.style.resize = 'none';
      
            // This removes scrollbars
      i.style.overflow = 'hidden';
     
      // Every input/change, grab the content
      content = i.value;

      // Add the same content to the hidden div
      
      // This is for old IE
      content = content.replace(/\n/g, '<br>');
      
      // The <br ..> part is for old IE
      // This also fixes the jumpy way the textarea grows if line-height isn't included
      hiddenDiv.innerHTML = content + '<br style="line-height: 3px;">';

      // Briefly make the hidden div block but invisible
      // This is in order to read the height
      hiddenDiv.style.visibility = 'hidden';
      hiddenDiv.style.display = 'block';
      i.style.height = hiddenDiv.offsetHeight + 'px';

      // Make the hidden div display:none again
      hiddenDiv.style.visibility = 'visible';
      hiddenDiv.style.display = 'none';
    });
  })(i);
}
</script>

<!-- Add html2canvas and jsPDF (CDN) -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
// Export table to PNG
document.getElementById('export-png').addEventListener('click', async () => {
  const table = document.querySelector('table');
  // ensure hiddenDiv doesn't affect capture
  const canvas = await html2canvas(table, { scale: 2, backgroundColor: '#ffffff', useCORS: true });
  const dataUrl = canvas.toDataURL('image/png');
  const link = document.createElement('a');
  link.href = dataUrl;
  link.download = 'platforms.png';
  link.click();
});

// Export table to PDF (A4 portrait)
document.getElementById('export-pdf').addEventListener('click', async () => {
  const { jsPDF } = window.jspdf;
  const table = document.querySelector('table');
  // capture as image
  const canvas = await html2canvas(table, { scale: 2, backgroundColor: '#ffffff', useCORS: true });
  const imgData = canvas.toDataURL('image/png');

  const pdf = new jsPDF('p', 'mm', 'a4');
  const pdfWidth = pdf.internal.pageSize.getWidth();
  const pdfHeight = pdf.internal.pageSize.getHeight();

  // compute image dims to keep aspect ratio
  const imgProps = pdf.getImageProperties(imgData);
  const imgWidthMm = pdfWidth;
  const imgHeightMm = (imgProps.height * imgWidthMm) / imgProps.width;

  if (imgHeightMm <= pdfHeight) {
    pdf.addImage(imgData, 'PNG', 0, 0, imgWidthMm, imgHeightMm);
  } else {
    // If long, tile image across pages
    let position = 0;
    let remainingHeight = imgHeightMm;
    // draw first page
    pdf.addImage(imgData, 'PNG', 0, position, imgWidthMm, imgHeightMm);
    remainingHeight -= pdfHeight;
    while (remainingHeight > 0) {
      position -= pdfHeight;
      pdf.addPage();
      pdf.addImage(imgData, 'PNG', 0, position, imgWidthMm, imgHeightMm);
      remainingHeight -= pdfHeight;
    }
  }

  pdf.save('platforms.pdf');
});
</script>
<style>
  /* small styles for the export buttons */
  #export-png, #export-pdf {
    background: var(--AIMblue);
    color: var(--white);
    border: none;
    padding: 8px 12px;
    font-family: inherit;
    cursor: pointer;
    border-radius: 4px;
  }
</style>
</html>